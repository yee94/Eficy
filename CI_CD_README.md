# CI/CD é…ç½®è¯´æ˜

æœ¬é¡¹ç›®å·²é…ç½®å®Œæ•´çš„ CI/CD å‘å¸ƒæµç¨‹ï¼ŒåŒ…æ‹¬è‡ªåŠ¨åŒ–æµ‹è¯•ã€æ„å»ºå’Œå‘å¸ƒã€‚

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. é…ç½® GitHub Secrets

åœ¨ GitHub ä»“åº“è®¾ç½®ä¸­æ·»åŠ ä»¥ä¸‹ secretsï¼š

- `NPM_TOKEN`: npm å‘å¸ƒä»¤ç‰Œ
- `CODECOV_TOKEN`: Codecov ä»¤ç‰Œï¼ˆå¯é€‰ï¼‰

### 2. ä½¿ç”¨ Changesets å‘å¸ƒ

```bash
# åˆ›å»º changeset
pnpm changeset

# æäº¤ changeset
git add .changeset/
git commit -m "feat: add changeset for new features"
git push

# æ‰‹åŠ¨å‘å¸ƒï¼ˆå¯é€‰ï¼‰
pnpm version
pnpm release
```

## ğŸ“‹ å·¥ä½œæµè¯´æ˜

### CI å·¥ä½œæµ (`.github/workflows/ci.yml`)

- **è§¦å‘æ¡ä»¶**: æ¨é€åˆ° master/develop åˆ†æ”¯æˆ– PR
- **åŠŸèƒ½**: 
  - ä¾èµ–å®‰è£…å’Œç¼“å­˜
  - æ„å»ºæ‰€æœ‰åŒ…
  - å¤š Node.js ç‰ˆæœ¬æµ‹è¯• (16, 18, 20)
  - ç±»å‹æ£€æŸ¥ï¼ˆä¾èµ–æ„å»ºäº§ç‰©ï¼‰
  - æµ‹è¯•è¦†ç›–ç‡æŠ¥å‘Š
  - ä¸Šä¼ æ„å»ºäº§ç‰©

### PR æ£€æŸ¥å·¥ä½œæµ (`.github/workflows/pr-check.yml`)

- **è§¦å‘æ¡ä»¶**: åˆ›å»º PR åˆ° master/develop åˆ†æ”¯
- **åŠŸèƒ½**:
  - ä¾èµ–å®‰è£…å’Œç¼“å­˜
  - æ„å»ºæ‰€æœ‰åŒ…
  - ç±»å‹æ£€æŸ¥ï¼ˆä¾èµ–æ„å»ºäº§ç‰©ï¼‰
  - å•å…ƒæµ‹è¯•
  - å®‰å…¨å®¡è®¡

### å‘å¸ƒå·¥ä½œæµ (`.github/workflows/release.yml`)

- **è§¦å‘æ¡ä»¶**: æ¨é€åˆ° master åˆ†æ”¯æˆ–æ‰‹åŠ¨è§¦å‘
- **åŠŸèƒ½**:
  - ä¾èµ–å®‰è£…å’Œç¼“å­˜
  - æ„å»ºæ‰€æœ‰åŒ…
  - ç±»å‹æ£€æŸ¥ï¼ˆä¾èµ–æ„å»ºäº§ç‰©ï¼‰
  - å•å…ƒæµ‹è¯•
  - ä½¿ç”¨ Changesets ç®¡ç†ç‰ˆæœ¬
  - è‡ªåŠ¨å‘å¸ƒåˆ° npm
  - åˆ›å»º GitHub Release

### Changesets PR å·¥ä½œæµ (`.github/workflows/changeset-pr.yml`)

- **è§¦å‘æ¡ä»¶**: åˆ›å»º PR åˆ° master åˆ†æ”¯
- **åŠŸèƒ½**:
  - æ£€æŸ¥ changesets
  - è‡ªåŠ¨åˆ›å»ºç‰ˆæœ¬ PR

## ğŸ› ï¸ è„šæœ¬è¯´æ˜

### Changesets å‘½ä»¤

```bash
# åˆ›å»º changeset
pnpm changeset

# åˆ›å»ºç‰ˆæœ¬ PR
pnpm version

# å‘å¸ƒåˆ° npm
pnpm release
```

### å¯ç”¨å‘½ä»¤

- `changeset` - åˆ›å»º changeset
- `version` - åˆ›å»ºç‰ˆæœ¬ PR
- `release` - å‘å¸ƒåˆ° npm

## ğŸ“¦ åŒ…ç®¡ç†

### æ”¯æŒçš„åŒ…

- `@eficy/core` - æ ¸å¿ƒåŒ…
- `@eficy/reactive` - å“åº”å¼çŠ¶æ€ç®¡ç†
- `@eficy/reactive-react` - React é›†æˆ
- `@eficy/reactive-async` - å¼‚æ­¥å“åº”å¼
- `@eficy/core-jsx` - JSX è¿è¡Œæ—¶
- `@eficy/plugin-unocss` - UnoCSS æ’ä»¶
- `@eficy/browser` - æµè§ˆå™¨è¿è¡Œæ—¶
- `@eficy/eficy` - ä¸»åŒ…

### ç‰ˆæœ¬ç®¡ç†

- ä½¿ç”¨è¯­ä¹‰åŒ–ç‰ˆæœ¬æ§åˆ¶ (Semantic Versioning)
- æ‰€æœ‰åŒ…ç‰ˆæœ¬åŒæ­¥æ›´æ–°
- æ”¯æŒé¢„å‘å¸ƒç‰ˆæœ¬ (alpha, beta, rc)

## ğŸ”§ é…ç½®è¯´æ˜

### Dependabot é…ç½® (`.github/dependabot.yml`)

- æ¯å‘¨ä¸€è‡ªåŠ¨æ£€æŸ¥ä¾èµ–æ›´æ–°
- æ”¯æŒ npm å’Œ GitHub Actions æ›´æ–°
- è‡ªåŠ¨åˆ›å»º PR å¹¶åˆ†é…å®¡æ ¸è€…

### å·¥ä½œæµé…ç½®

- ä½¿ç”¨ pnpm ä½œä¸ºåŒ…ç®¡ç†å™¨
- Node.js 18 ä½œä¸ºä¸»è¦ç‰ˆæœ¬
- æ”¯æŒç¼“å­˜ä¼˜åŒ–æ„å»ºé€Ÿåº¦
- å¹¶è¡Œæ‰§è¡Œæµ‹è¯•å’Œæ„å»º

## ğŸš¨ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **å‘å¸ƒå¤±è´¥**
   - æ£€æŸ¥ NPM_TOKEN æ˜¯å¦æ­£ç¡®
   - ç¡®ä¿æ‰€æœ‰æµ‹è¯•é€šè¿‡
   - æ£€æŸ¥ç‰ˆæœ¬å·æ ¼å¼

2. **æ„å»ºå¤±è´¥**
   - æ£€æŸ¥ä¾èµ–æ˜¯å¦æ­£ç¡®å®‰è£…
   - æŸ¥çœ‹æ„å»ºæ—¥å¿—
   - ç¡®ä¿ TypeScript ç±»å‹æ£€æŸ¥é€šè¿‡

3. **æµ‹è¯•å¤±è´¥**
   - æ£€æŸ¥æµ‹è¯•ç¯å¢ƒé…ç½®
   - æŸ¥çœ‹æµ‹è¯•è¦†ç›–ç‡æŠ¥å‘Š
   - ç¡®ä¿æ‰€æœ‰ä¾èµ–ç‰ˆæœ¬å…¼å®¹

### è°ƒè¯•å‘½ä»¤

```bash
# æœ¬åœ°æµ‹è¯•æ„å»º
pnpm build

# æœ¬åœ°è¿è¡Œæµ‹è¯•
pnpm test

# æ£€æŸ¥ç±»å‹
pnpm -r typecheck

# æ£€æŸ¥æ ¼å¼
pnpm prettier --check .
```

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [å‘å¸ƒæŒ‡å—](./RELEASE.md)
- [å˜æ›´æ—¥å¿—](./CHANGELOG.md)
- [GitHub Actions æ–‡æ¡£](https://docs.github.com/en/actions)

## ğŸ¤ è´¡çŒ®æŒ‡å—

1. Fork é¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯
3. æäº¤æ›´æ”¹
4. æ¨é€åˆ°åˆ†æ”¯
5. åˆ›å»º Pull Request

## ğŸ“ æ”¯æŒ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·ï¼š
1. æŸ¥çœ‹ GitHub Issues
2. åˆ›å»ºæ–°çš„ Issue
3. è”ç³»ç»´æŠ¤å›¢é˜Ÿ
